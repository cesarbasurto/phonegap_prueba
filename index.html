<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8" />
        <title>PhoneGap Demo</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script type="text/javascript" charset="utf-8"></script>
        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css">
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
		<script type="text/javascript" charset="utf-8">
		//*********************************************************
		// Wait for Cordova to Load
		//*********************************************************
		
	    var rootDir = "file:///mnt/sdcard";
	    var appHomeDir = "Android/data/com.ventusmoso.pg2_jqm";
	
	    //*********************************************************    
	    // Prepare dir for file and storage features
	    //*********************************************************  
	    function createFileDir() {
	
	        function fsOnError(error) {
	            alert("Cannot get to root file system. Code: " + error.message)
	        }
	        function dirOnError(error) {
	            alert("Cannot create dir. Code: " + error.code)
	        }
	        function fsOnSuccess(fileSystem) {
	            fileSystem.root.getDirectory(appHomeDir, {create: true, exclusive: false}, null, dirOnError);
	        }
	
	        window.requestFileSystem( LocalFileSystem.PERSISTENT, 0, fsOnSuccess, fsOnError );
	    }


    	document.addEventListener("deviceready", onDeviceReady, false);
    	function onDeviceReady() {
			 $("#main h1#appTitle").html("PhoneGap " + device.cordova + " Demo");       
	       // addBackbuttonListener();
	        createFileDir();
			
		}
		
		document.addEventListener("backbutton", function() {
            if ( $('.ui-page-active').attr('id') == 'main') {
                exitAppPopup();
            } else {
                history.back();             
            }
        }, false);
        
        function exitAppPopup() {
		    navigator.notification.confirm(
		          'Exit PhoneGap ' + device.cordova + ' Demo?'
		        , function(button) {
		              if (button == 2) {
		                  navigator.app.exitApp();
		              } 
		          }
		        , 'Exit'
		        , 'No,Yes'
		    );  
		    return false;
		}
		
		
        
	     function updateNotificationStatus(status) {
	        $("#notificationStatus").empty();
	        $("#notificationStatus").append(status).trigger("create");
	    }
	
	    function getNotificationReady() {
	        updateNotificationStatus("");   
	    }
	    
	    function alertCB() {
	        updateNotificationStatus("Alert is picked");
	    }
    
	    function confirmCB(button) {
	        var btnText;
	        
	        switch (button) {
	            case 1:
	                btnText = "Green";
	                break;
	            case 2:
	                btnText = "Red";
	                break;
	        }
	
	        updateNotificationStatus("Confirm: You selected the \"" + btnText +  "\" button");
	        $("#colorBox").css({"background-color": btnText})
	        $("#notificationConfirm").popup({positionTo: "window"});
	        $("#notificationConfirm").popup("open");        
	    }
	    
	    function alertNotification() {
	        navigator.notification.alert(
	              'Alert Notification'
	            , alertCB
	            , 'Title | Alert'
	            , 'Done'
	        );
	    }
	    function confirmNotification() {
	        navigator.notification.confirm(
	              'Which color do you like most?'
	            , confirmCB
	            , 'Title | Confirm'
	            , 'Green,Red'
	        );  
	    }
	    function beepNotification() {
	        navigator.notification.beep(3); 
	        updateNotificationStatus("Beep is picked");
	    }
	    function vibrateNotification() {
	        navigator.notification.vibrate(2000);
	        updateNotificationStatus("Vibrate is picked");
	    }
	   
		</script>
		
		<script type="text/javascript" charset="utf-8"> 
		var watchID = null;
		
		function getaccelerometer(){
			
			 startWatch();
		}
		function startWatch() {

	        // Update acceleration every 3 seconds
	        var options = { frequency: 3000 };
	
	        watchID = navigator.accelerometer.watchAcceleration(onSuccess, onError, options);
	    }
	
	    // Stop watching the acceleration
	    //
	    function stopWatch() {
	        if (watchID) {
	            navigator.accelerometer.clearWatch(watchID);
	            watchID = null;
	        }
	    }
	
	    // onSuccess: Get a snapshot of the current acceleration
	    //
	    function onSuccess(acceleration) {
	    	
	    	$("#accelerometer_text").empty();
	    	$("#accelerometer_text").text('Acceleration X: ' + acceleration.x + '<br />' +
		                            'Acceleration Y: ' + acceleration.y + '<br />' +
		                            'Acceleration Z: ' + acceleration.z + '<br />' +
		                            'Timestamp: '      + acceleration.timestamp + '<br />');
	     
	    }
	
	    // onError: Failed to get the acceleration
	    //
	    function onError() {
	        alert('onError!');
	    }
			
    
</script>
	</head>
	<body>
			<!---------------------------------- Main Page --------------------------------------->
		<div data-role="page" id="main">
		    <div data-role="header" data-position="fixed">
		        <h1 id="appTitle"></h1>
		    </div>
		    <div data-role="content">   
		    <ul data-role="listview" data-inset="true" data-filter="true">
		        <li><a href="#notificationCap" data-transition="slide" onclick="getNotificationReady();">Notification</a></li>
		        <li><a href="#accelerometer" data-transition="slide" onclick="getaccelerometer();">accelerometer</a></li>
		     </ul>
		    </div>
		</div>
		
		<!---------------------------------- Notification ------------------------------------>
		<div data-role="page" data-add-back-btn="true" back-btn-text="back" id="notificationCap">
		    <div data-role="header">
		        <h1>Notification</h1>
		    </div>
		    <div data-role="content">
		        <ul data-role="listview" data-inset="true">
		            <li><a href="#" onclick="alertNotification();"  >Alert</a></li>
		            <li><a href="#" onclick="confirmNotification();">Confirm</a></li>
		            <li><a href="#" onclick="beepNotification();"   >Beep</a></li>
		            <li><a href="#" onclick="vibrateNotification();">Vibrate</a></li>
		        </ul>
		        <div class="mesgBox">
		            <ul class="smFont">
		                <li>Alert   - Show alert box</li>
		                <li>Confirm - Show confirm message box</li>
		                <li>Beep    - Will beep 3 times</li>
		                <li>Vibrate - Will vibrate for 2 sec</li>
		            </ul>           
		        </div>  
		
		<!---------------------------------- Notification: Confirm --------------------------->
		        <div data-role="popup" id="notificationConfirm" class="ui-content" data-theme="e" data-transitione="pop">
		            <h3>Confirmation - Selection</h3>
		            <h5 class="hlabel">You've picked...</h5>
		            <div id="colorBox"></div>
		            <button onclick="$('#notificationConfirm').popup('close');">Close</button>
		        </div>
		    </div>
		    <div data-role="footer">
		        <div id="notificationStatus"></div>
		    </div>          
		</div>
		<div data-role="page" data-add-back-btn="true" back-btn-text="back" id="accelerometer">
		    <div data-role="header">
		        <h1>accelerometer</h1>
		    </div>
		    <div data-role="content">
		         <div id="accelerometer_text">Waiting for accelerometer...</div>
        		 <button onclick="stopWatch();">Stop Watching</button>
		    </div>
		    <div data-role="footer">
		        <div id="geolocationStatus"></div>
		    </div>
		</div>
	</body>
</html>
